#!/usr/bin/env bash

# Read bookmarks file
bookmarks_file="$HOME/.config/rofi/bookmarks.txt"

# Parse bookmarks into rofi format: "Category :: Name"
options=$(grep -v '^$' "$bookmarks_file" | sed 's/ :: / :: /')

# Show rofi menu
chosen=$(echo -e "$options" | rofi -dmenu -i -p "Open Bookmark" \
    -theme-str 'window {width: 30%;} listview {lines: 6;}')

# If nothing selected or user just pressed enter, launch thorium
if [ -z "$chosen" ]; then
    thorium-browser &
    exit 0
fi

# Extract the URL (everything after the last ::)
url=$(echo "$chosen" | sed 's/.*:: //')

# Determine which browser to use based on category
if echo "$chosen" | grep -q '^\[Personal\]'; then
   chromium "$url" &
else
    brave "$url" &
fi
