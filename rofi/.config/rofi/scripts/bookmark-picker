#!/usr/bin/env bash
# Read bookmarks file
bookmarks_file="$HOME/.config/rofi/scripts/bookmarks.txt"

# Parse bookmarks into rofi format: "Category :: Name"
options=$(grep -v '^$' "$bookmarks_file" | sed 's/ :: / :: /')

# Add "Open Browser (Clean)" option at the top
options="Open Browser 
$options"

# Show rofi menu
chosen=$(echo -e "$options" | rofi -dmenu -i -p "Open Bookmark" \
    -theme-str 'window {width: 30%;} listview {lines: 6;}')

# If nothing selected, exit
if [ -z "$chosen" ]; then
    exit 0
fi

# If "Open Browser (Clean)" is selected, launch chromium and exit
if echo "$chosen" | grep -q 'Open Browser'; then
    chromium &
    exit 0
fi

# Extract the URL (everything after the last ::)
url=$(echo "$chosen" | sed 's/.*:: //')

# Determine which browser to use based on category
if echo "$chosen" | grep -q '^\[Personal\]'; then
   chromium "$url" &
else
    brave "$url" &
fi
